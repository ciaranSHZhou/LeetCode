TC: O(1), we only mark one per move
SC: O(n)